<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="利用mysql的存储过程快速插入大量数据
1DELIMITER $$ 2 3USE `test`$$ 4 5DROP PROCEDURE IF EXISTS `add_user_batch`$$ 6 7CREATE DEFINER=`root`@`%` PROCEDURE `add_user_batch`(IN COUNT INT) 8BEGIN 9 DECLARE i INT; 10 DECLARE t_name VARCHAR(8); 11 DECLARE t_tag VARCHAR(20); 12 DECLARE t_age INT(2); 13 DECLARE t_sql_template VARCHAR(100); 14 DECLARE t_sql TEXT; 15 DECLARE t_tag_mod_val INT DEFAULT(25); 16 DECLARE t_commit_mod_val INT DEFAULT(100); 17 18 DECLARE t_start_time DATETIME; 19 DECLARE t_end_time DATETIME; 20 21 TRUNCATE TABLE `system_user`; 22 23 SET t_start_time=NOW(); 24 SET t_sql_template = &#34;INSERT INTO `system_user`(NAME, age, tag) VALUES&#34;; 25 SET t_sql = t_sql_template; 26 SET i = 1; 27 WHILE i &lt;= COUNT 28 DO 29 SET t_age = FLOOR(1 &#43; RAND() * 60); 30 SET t_name = LEFT(UUID(), 8); 31 -- 给tag随机制造空值 32 IF MOD(i, t_tag_mod_val) = 0 THEN 33 SET t_tag = &#34;NULL&#34;; 34 ELSE 35 SET t_tag = CONCAT(&#34;&#39;&#34;,LEFT(UUID(), 8),&#34;&#39;&#34;); 36 END IF; 37 38 SET t_sql = CONCAT(t_sql,&#34;(&#39;&#34;,t_name,&#34;&#39;,&#34;,t_age,&#34;,&#34;,t_tag,&#34;)&#34;); 39 40 IF MOD(i,t_commit_mod_val) !">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://tech.lucumt.info/docs/code/block/mysql-batch-create-data/">
  <meta property="og:site_name" content="个人笔记">
  <meta property="og:title" content="批量制造数据">
  <meta property="og:description" content="利用mysql的存储过程快速插入大量数据
1DELIMITER $$ 2 3USE `test`$$ 4 5DROP PROCEDURE IF EXISTS `add_user_batch`$$ 6 7CREATE DEFINER=`root`@`%` PROCEDURE `add_user_batch`(IN COUNT INT) 8BEGIN 9 DECLARE i INT; 10 DECLARE t_name VARCHAR(8); 11 DECLARE t_tag VARCHAR(20); 12 DECLARE t_age INT(2); 13 DECLARE t_sql_template VARCHAR(100); 14 DECLARE t_sql TEXT; 15 DECLARE t_tag_mod_val INT DEFAULT(25); 16 DECLARE t_commit_mod_val INT DEFAULT(100); 17 18 DECLARE t_start_time DATETIME; 19 DECLARE t_end_time DATETIME; 20 21 TRUNCATE TABLE `system_user`; 22 23 SET t_start_time=NOW(); 24 SET t_sql_template = &#34;INSERT INTO `system_user`(NAME, age, tag) VALUES&#34;; 25 SET t_sql = t_sql_template; 26 SET i = 1; 27 WHILE i &lt;= COUNT 28 DO 29 SET t_age = FLOOR(1 &#43; RAND() * 60); 30 SET t_name = LEFT(UUID(), 8); 31 -- 给tag随机制造空值 32 IF MOD(i, t_tag_mod_val) = 0 THEN 33 SET t_tag = &#34;NULL&#34;; 34 ELSE 35 SET t_tag = CONCAT(&#34;&#39;&#34;,LEFT(UUID(), 8),&#34;&#39;&#34;); 36 END IF; 37 38 SET t_sql = CONCAT(t_sql,&#34;(&#39;&#34;,t_name,&#34;&#39;,&#34;,t_age,&#34;,&#34;,t_tag,&#34;)&#34;); 39 40 IF MOD(i,t_commit_mod_val) !">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>批量制造数据 | 个人笔记</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" >
<link rel="canonical" href="https://tech.lucumt.info/docs/code/block/mysql-batch-create-data/">
<link rel="stylesheet" href="/book.min.ab82d6254717c0331f51dc4e4c363df29059b2ef00cfa2b23e8d24372d4137e4.css" integrity="sha256-q4LWJUcXwDMfUdxOTDY98pBZsu8Az6KyPo0kNy1BN&#43;Q=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.c5ee532ff0253dc42f9b87551bccedabe0ebabb94578ac99b6f786b721f67040.js" integrity="sha256-xe5TL/AlPcQvm4dVG8ztq&#43;Drq7lFeKyZtveGtyH2cEA=" crossorigin="anonymous"></script>

  

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>个人笔记</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-52a19f941dcfe66de6ed1cd418a84103" class="toggle"  />
    <label for="section-52a19f941dcfe66de6ed1cd418a84103" class="flex justify-between">
      <a role="button" class="">Linux</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a7afcaf46e150f46a978893f31be4a48" class="toggle"  />
    <label for="section-a7afcaf46e150f46a978893f31be4a48" class="flex justify-between">
      <a role="button" class="">Linux系统</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/linux/system/linux-file-system/" class="">文件类型说明</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/linux/system/linux-file-permissions/" class="">文件权限说明</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-5d396b9ad5f816a37baf43734deffc7c" class="toggle"  />
    <label for="section-5d396b9ad5f816a37baf43734deffc7c" class="flex justify-between">
      <a role="button" class="">网络</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/network/http-status/" class="">HTTP状态码</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b0b4a016bddda14181aeb79f92565d38" class="toggle" checked />
    <label for="section-b0b4a016bddda14181aeb79f92565d38" class="flex justify-between">
      <a role="button" class="">编程</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-568f71b95ca56c34a1f8e3361712f1c0" class="toggle"  />
    <label for="section-568f71b95ca56c34a1f8e3361712f1c0" class="flex justify-between">
      <a role="button" class="">理论</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/code/theory/language-compare/" class="">不同语言的工作原理</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a492e0e982492102fba29e206d0fb4b6" class="toggle" checked />
    <label for="section-a492e0e982492102fba29e206d0fb4b6" class="flex justify-between">
      <a role="button" class="">代码块</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/code/block/mysql-batch-create-data/" class="active">批量制造数据</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2c49013a399c9c118baaabbde9c86f47" class="toggle"  />
    <label for="section-2c49013a399c9c118baaabbde9c86f47" class="flex justify-between">
      <a role="button" class="">安全相关</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/security/identity-manage-types/" class="">不同的身份管理方式</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/security/authentication-types-compare/" class="">不同认证方式的对比</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d94d98ae724428f34f2a0587e52dd96c" class="toggle"  />
    <label for="section-d94d98ae724428f34f2a0587e52dd96c" class="flex justify-between">
      <a role="button" class="">微服务</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bfd46b2f9bd0e36ee3189e636de386fc" class="toggle"  />
    <label for="section-bfd46b2f9bd0e36ee3189e636de386fc" class="flex justify-between">
      <a role="button" class="">微服务开发</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/microservice/develop/what-does-api-gateway-do/" class="">网关的作用</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/microservice/develop/microservice-best-practices/" class="">微服务最佳实践</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f333c9def04102358b545028113318cb" class="toggle"  />
    <label for="section-f333c9def04102358b545028113318cb" class="flex justify-between">
      <a role="button" class="">测试相关</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/test/test-method-compare/" class="">测试方法对比</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/test/9-types-api-testing/" class="">9中API测试方式</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-fd2a4e7f9ddea45452efb530b97de696" class="toggle"  />
    <label for="section-fd2a4e7f9ddea45452efb530b97de696" class="flex justify-between">
      <a role="button" class="">其它</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/other/how-visa-make-money/" class="">Visa是如何挣钱的</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>批量制造数据</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents"></nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><p>利用<code>mysql</code>的存储过程快速插入大量数据</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>DELIMITER<span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">$$</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">USE</span><span style="color:#bbb"> </span>`test`<span style="color:#a61717;background-color:#e3d2d2">$$</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">PROCEDURE</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">IF</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>`add_user_batch`<span style="color:#a61717;background-color:#e3d2d2">$$</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">CREATE</span><span style="color:#bbb"> </span>DEFINER=`root`@`%`<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">PROCEDURE</span><span style="color:#bbb"> </span>`add_user_batch`(<span style="color:#8b008b;font-weight:bold">IN</span><span style="color:#bbb"> </span>COUNT<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">INT</span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span><span style="color:#bbb"></span>BEGIN<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">INT</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>t_name<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">VARCHAR</span>(<span style="color:#b452cd">8</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>t_tag<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">VARCHAR</span>(<span style="color:#b452cd">20</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>t_age<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">INT</span>(<span style="color:#b452cd">2</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>t_sql_template<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">VARCHAR</span>(<span style="color:#b452cd">100</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>t_sql<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">TEXT</span>;<span style="color:#bbb">   
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>t_tag_mod_val<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">INT</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">DEFAULT</span>(<span style="color:#b452cd">25</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>t_commit_mod_val<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">INT</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">DEFAULT</span>(<span style="color:#b452cd">100</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span><span style="color:#bbb">    
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>t_start_time<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">DATETIME</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>t_end_time<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">DATETIME</span>;<span style="color:#bbb">    
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span><span style="color:#bbb">    
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span><span style="color:#bbb">    </span>TRUNCATE<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>`system_user`;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span><span style="color:#bbb">    
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span><span style="color:#bbb">    </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_start_time=<span style="color:#008b45">NOW</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span><span style="color:#bbb">    </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_sql_template<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#cd5555">&#34;INSERT INTO `system_user`(NAME, age, tag) VALUES&#34;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span><span style="color:#bbb">    </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_sql<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>t_sql_template;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span><span style="color:#bbb">    </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#b452cd">1</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">WHILE</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>&lt;=<span style="color:#bbb"> </span>COUNT<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span><span style="color:#bbb">        </span>DO<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span><span style="color:#bbb">            </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_age<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#008b45">FLOOR</span>(<span style="color:#b452cd">1</span><span style="color:#bbb"> </span>+<span style="color:#bbb"> </span><span style="color:#008b45">RAND</span>()<span style="color:#bbb"> </span>*<span style="color:#bbb"> </span><span style="color:#b452cd">60</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span><span style="color:#bbb">            </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_name<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">LEFT</span>(<span style="color:#008b45">UUID</span>(),<span style="color:#bbb"> </span><span style="color:#b452cd">8</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span><span style="color:#bbb">            </span><span style="color:#228b22">-- 给tag随机制造空值
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span><span style="color:#228b22"></span><span style="color:#bbb">            </span><span style="color:#8b008b;font-weight:bold">IF</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">MOD</span>(i,<span style="color:#bbb"> </span>t_tag_mod_val)<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#b452cd">0</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">THEN</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span><span style="color:#bbb">                </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_tag<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#cd5555">&#34;NULL&#34;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span><span style="color:#bbb">            </span><span style="color:#8b008b;font-weight:bold">ELSE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span><span style="color:#bbb">                </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_tag<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#008b45">CONCAT</span>(<span style="color:#cd5555">&#34;&#39;&#34;</span>,<span style="color:#8b008b;font-weight:bold">LEFT</span>(<span style="color:#008b45">UUID</span>(),<span style="color:#bbb"> </span><span style="color:#b452cd">8</span>),<span style="color:#cd5555">&#34;&#39;&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span><span style="color:#bbb">            </span>END<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">IF</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span><span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span><span style="color:#bbb">            </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_sql<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#008b45">CONCAT</span>(t_sql,<span style="color:#cd5555">&#34;(&#39;&#34;</span>,t_name,<span style="color:#cd5555">&#34;&#39;,&#34;</span>,t_age,<span style="color:#cd5555">&#34;,&#34;</span>,t_tag,<span style="color:#cd5555">&#34;)&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span><span style="color:#bbb">            
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span><span style="color:#bbb">            </span><span style="color:#8b008b;font-weight:bold">IF</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">MOD</span>(i,t_commit_mod_val)<span style="color:#bbb"> </span>!=<span style="color:#bbb"> </span><span style="color:#b452cd">0</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">THEN</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span><span style="color:#bbb">              </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_sql<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#008b45">CONCAT</span>(t_sql,<span style="color:#cd5555">&#34;,&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span><span style="color:#bbb">            </span><span style="color:#8b008b;font-weight:bold">ELSE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span><span style="color:#bbb">              </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_sql<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#008b45">CONCAT</span>(t_sql,<span style="color:#cd5555">&#34;;&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span><span style="color:#bbb">                   </span><span style="color:#228b22">-- 只要达到t_commit_mod_val要求的次数，就执行并提交
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span><span style="color:#228b22"></span><span style="color:#bbb">                   </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>@insert_sql<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>t_sql;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span><span style="color:#bbb">                   </span>PREPARE<span style="color:#bbb"> </span>stmt<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#bbb"> </span>@insert_sql;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span><span style="color:#bbb">                   </span>EXECUTE<span style="color:#bbb"> </span>stmt;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span><span style="color:#bbb">                   </span>DEALLOCATE<span style="color:#bbb"> </span>PREPARE<span style="color:#bbb"> </span>stmt;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span><span style="color:#bbb">                   </span>COMMIT;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span><span style="color:#bbb">              </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_sql=t_sql_template;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span><span style="color:#bbb">            </span>END<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">IF</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span><span style="color:#bbb">            </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>+<span style="color:#bbb"> </span><span style="color:#b452cd">1</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span><span style="color:#bbb">        </span>END<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">WHILE</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span><span><span style="color:#bbb">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span><span style="color:#bbb">        </span><span style="color:#228b22">-- 不能被t_commit_mod_val整除时，余下的数据处理
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span><span style="color:#228b22"></span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">IF</span><span style="color:#bbb"> </span><span style="color:#008b45">LENGTH</span>(t_sql)<span style="color:#bbb"> </span>&gt;<span style="color:#bbb"> </span><span style="color:#008b45">LENGTH</span>(t_sql_template)<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">THEN</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span><span style="color:#bbb">                   </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_sql=<span style="color:#008b45">CONCAT</span>(<span style="color:#008b45">SUBSTRING</span>(t_sql,<span style="color:#b452cd">1</span>,<span style="color:#008b45">LENGTH</span>(t_sql)-<span style="color:#b452cd">1</span>),<span style="color:#cd5555">&#39;;&#39;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span><span><span style="color:#bbb">                   </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>@insert_sql<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>t_sql;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span><span><span style="color:#bbb">                   </span>PREPARE<span style="color:#bbb"> </span>stmt<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#bbb"> </span>@insert_sql;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span><span><span style="color:#bbb">                   </span>EXECUTE<span style="color:#bbb"> </span>stmt;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span><span><span style="color:#bbb">                   </span>DEALLOCATE<span style="color:#bbb"> </span>PREPARE<span style="color:#bbb"> </span>stmt;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span><span><span style="color:#bbb">                   </span>COMMIT;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span><span><span style="color:#bbb">        </span>END<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">IF</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span><span><span style="color:#bbb">        </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>t_end_time=<span style="color:#008b45">NOW</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#008b45">CONCAT</span>(<span style="color:#cd5555">&#39;insert data success,time cost &#39;</span>,<span style="color:#008b45">TIMEDIFF</span>(t_end_time,t_start_time))<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">AS</span><span style="color:#bbb"> </span>finishedTag;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span><span><span style="color:#bbb"></span>END<span style="color:#a61717;background-color:#e3d2d2">$$</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67</span><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68</span><span><span style="color:#bbb"></span>DELIMITER<span style="color:#bbb"> </span>;<span style="color:#bbb">
</span></span></span></code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents"></nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












